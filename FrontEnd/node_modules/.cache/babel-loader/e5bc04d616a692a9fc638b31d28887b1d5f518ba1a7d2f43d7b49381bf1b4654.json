{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nexport const login = createAsyncThunk(\"auth/login\", async ({\n  email,\n  password\n}, {\n  dispatch\n}) => {\n  const response = await fetch(\"http://localhost:3001/api/v1/user/login\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      email,\n      password\n    })\n  });\n  if (!response.ok) {\n    throw new Error(\"Erreur lors de la connexion\");\n  }\n  const data = await response.json();\n  const token = data.token;\n  const username = data.username; // Récupération du nom d'utilisateur\n\n  localStorage.setItem(\"accessToken\", token);\n  dispatch(username(username)); // Mise à jour de l'état Redux avec le nom d'utilisateur\n  return data;\n});\n/*export const login = createAsyncThunk(\r\n  \"auth/login\",\r\n  async ({ email, password }) => {\r\n    //appel API pour récupérer le token lors de l'authentification par le biais de l'email et du mot de passe\r\n    const response = await fetch(\"http://localhost:3001/api/v1/user/login\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(\"Erreur lors de la connexion\");\r\n    }\r\n\r\n    const data = await response.json();\r\n    //affichage du jeton d'authentification (token)\r\n    const token = data.token;\r\n    localStorage.setItem(\"accessToken\", token); // stockage du jeton\r\n    return data;\r\n  }\r\n);\r\n\r\n// Thunk pour récupérer le profil de l'utilisateur\r\nexport const fetchUserProfile = createAsyncThunk(\r\n  \"auth/fetchUserProfile\",\r\n  async (_, { getState }) => {\r\n    const { accessToken, userName } = getState().auth;\r\n\r\n    const response = await fetch(\"http://localhost:3001/api/v1/user/profile\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n      },\r\n      body: JSON.stringify({ userName }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      // Si la réponse n'est pas ok, nous lançons une erreur\r\n      throw new Error(\r\n        \"Erreur lors de la récupération du profil de l'utilisateur\"\r\n      );\r\n    }\r\n\r\n    const data = await response.json();\r\n    // Retourne les données contenant le nom d'utilisateur (username)\r\n    return data;\r\n  }\r\n);*/\n/*export const fetchUserProfile = createAsyncThunk(\r\n  \"auth/fetchUserProfile\",\r\n  async (_, { getState }) => {\r\n    const { accessToken, userName } = getState().auth;\r\n\r\n    const response = await fetch(\"http://localhost:3001/api/v1/user/profile\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n      },\r\n      body: JSON.stringify({ userName }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      // Si la réponse n'est pas ok, nous lançons une erreur\r\n      throw new Error(\r\n        \"Erreur lors de la récupération du profil de l'utilisateur\"\r\n      );\r\n    }\r\n\r\n    const data = await response.json();\r\n    // Retourne les données contenant le nom d'utilisateur (username)\r\n    return data;\r\n  }\r\n);*/\n\n/*import { createAsyncThunk } from \"@reduxjs/toolkit\";\r\n\r\n// Action pour la connexion\r\nexport const signIn = createAsyncThunk(\r\n  \"auth/signIn\",\r\n  async ({ email, password }, thunkAPI) => {\r\n    try {\r\n      // Appel API pour la connexion\r\n      const response = await fetch(\"http://localhost:3001/api/v1/user/login\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ email, password }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        // Gestion des erreurs de l'API, transmettre correctment au  reducer\r\n        const error = await response.json();\r\n        thunkAPI.rejectWithValue({ erreur: error.value });\r\n        console.log(error);\r\n      }\r\n\r\n      const data = await response.json();\r\n      return data.body.token;\r\n    } catch (error) {\r\n      // Gestion des erreurs réseau\r\n      thunkAPI.rejectWithValue({ erreur: error.value });\r\n      console.log(error);\r\n    }\r\n  }\r\n);\r\n*/","map":{"version":3,"names":["createSlice","createAsyncThunk","login","email","password","dispatch","response","fetch","method","headers","body","JSON","stringify","ok","Error","data","json","token","username","localStorage","setItem"],"sources":["C:/Users/elodi/OneDrive/Documents/ArgentBank-website/FrontEnd/src/actions/authActions.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\r\n\r\nexport const login = createAsyncThunk(\r\n  \"auth/login\",\r\n  async ({ email, password }, { dispatch }) => {\r\n    const response = await fetch(\"http://localhost:3001/api/v1/user/login\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(\"Erreur lors de la connexion\");\r\n    }\r\n\r\n    const data = await response.json();\r\n    const token = data.token;\r\n    const username = data.username; // Récupération du nom d'utilisateur\r\n\r\n    localStorage.setItem(\"accessToken\", token);\r\n    dispatch(username(username)); // Mise à jour de l'état Redux avec le nom d'utilisateur\r\n    return data;\r\n  }\r\n);\r\n/*export const login = createAsyncThunk(\r\n  \"auth/login\",\r\n  async ({ email, password }) => {\r\n    //appel API pour récupérer le token lors de l'authentification par le biais de l'email et du mot de passe\r\n    const response = await fetch(\"http://localhost:3001/api/v1/user/login\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(\"Erreur lors de la connexion\");\r\n    }\r\n\r\n    const data = await response.json();\r\n    //affichage du jeton d'authentification (token)\r\n    const token = data.token;\r\n    localStorage.setItem(\"accessToken\", token); // stockage du jeton\r\n    return data;\r\n  }\r\n);\r\n\r\n// Thunk pour récupérer le profil de l'utilisateur\r\nexport const fetchUserProfile = createAsyncThunk(\r\n  \"auth/fetchUserProfile\",\r\n  async (_, { getState }) => {\r\n    const { accessToken, userName } = getState().auth;\r\n\r\n    const response = await fetch(\"http://localhost:3001/api/v1/user/profile\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n      },\r\n      body: JSON.stringify({ userName }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      // Si la réponse n'est pas ok, nous lançons une erreur\r\n      throw new Error(\r\n        \"Erreur lors de la récupération du profil de l'utilisateur\"\r\n      );\r\n    }\r\n\r\n    const data = await response.json();\r\n    // Retourne les données contenant le nom d'utilisateur (username)\r\n    return data;\r\n  }\r\n);*/\r\n/*export const fetchUserProfile = createAsyncThunk(\r\n  \"auth/fetchUserProfile\",\r\n  async (_, { getState }) => {\r\n    const { accessToken, userName } = getState().auth;\r\n\r\n    const response = await fetch(\"http://localhost:3001/api/v1/user/profile\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n      },\r\n      body: JSON.stringify({ userName }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      // Si la réponse n'est pas ok, nous lançons une erreur\r\n      throw new Error(\r\n        \"Erreur lors de la récupération du profil de l'utilisateur\"\r\n      );\r\n    }\r\n\r\n    const data = await response.json();\r\n    // Retourne les données contenant le nom d'utilisateur (username)\r\n    return data;\r\n  }\r\n);*/\r\n\r\n/*import { createAsyncThunk } from \"@reduxjs/toolkit\";\r\n\r\n// Action pour la connexion\r\nexport const signIn = createAsyncThunk(\r\n  \"auth/signIn\",\r\n  async ({ email, password }, thunkAPI) => {\r\n    try {\r\n      // Appel API pour la connexion\r\n      const response = await fetch(\"http://localhost:3001/api/v1/user/login\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ email, password }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        // Gestion des erreurs de l'API, transmettre correctment au  reducer\r\n        const error = await response.json();\r\n        thunkAPI.rejectWithValue({ erreur: error.value });\r\n        console.log(error);\r\n      }\r\n\r\n      const data = await response.json();\r\n      return data.body.token;\r\n    } catch (error) {\r\n      // Gestion des erreurs réseau\r\n      thunkAPI.rejectWithValue({ erreur: error.value });\r\n      console.log(error);\r\n    }\r\n  }\r\n);\r\n*/\r\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAEhE,OAAO,MAAMC,KAAK,GAAGD,gBAAgB,CACnC,YAAY,EACZ,OAAO;EAAEE,KAAK;EAAEC;AAAS,CAAC,EAAE;EAAEC;AAAS,CAAC,KAAK;EAC3C,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,yCAAyC,EAAE;IACtEC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MACP,cAAc,EAAE;IAClB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAET,KAAK;MAAEC;IAAS,CAAC;EAC1C,CAAC,CAAC;EAEF,IAAI,CAACE,QAAQ,CAACO,EAAE,EAAE;IAChB,MAAM,IAAIC,KAAK,CAAC,6BAA6B,CAAC;EAChD;EAEA,MAAMC,IAAI,GAAG,MAAMT,QAAQ,CAACU,IAAI,CAAC,CAAC;EAClC,MAAMC,KAAK,GAAGF,IAAI,CAACE,KAAK;EACxB,MAAMC,QAAQ,GAAGH,IAAI,CAACG,QAAQ,CAAC,CAAC;;EAEhCC,YAAY,CAACC,OAAO,CAAC,aAAa,EAAEH,KAAK,CAAC;EAC1CZ,QAAQ,CAACa,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC9B,OAAOH,IAAI;AACb,CACF,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}